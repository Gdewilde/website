<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Stargate quickstart :: Stargate documentation</title>
    <meta name="generator" content="Antora 2.3.3">
    <link rel="stylesheet" href="../../../assets/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a href="https://stargate.io"><img src="../../../assets/img/logos/stargate-logo-horizontal.svg" style="height:40px" /></a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://stargate.io">Stargate</a>
        <!-- <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">API docs</div>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="">0.1</a>
          </div>
        </div> -->
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Community</div>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://github.com/stargate/docs/issues">File a bug</a>
            <a class="navbar-item" href="https://groups.google.com/a/lists.stargate.io/g/stargate-users">Ask a question</a>
            <a class="navbar-item" href="https://twitter.com/stargateio">Follow us on Twitter</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="https://github.com/stargate/">Stargate GitHub</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="stargate" data-version="0.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Stargate</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="quick_start.html">Quick start</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../concepts/concepts.html">Concepts</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../developers-guide/docker.html">Installing Stargate</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../developers-guide/cql.html">Using the CQL API</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://cassandra.apache.org/doc/latest/cql/">CQL reference</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../developers-guide/building.html">Building Stargate from source</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../FAQ.html">FAQ</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Stargate</span>
    <span class="version">0.1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Stargate</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">0.1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="quick_start.html" class="home-link is-current"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Stargate</a></li>
    <li><a href="quick_start.html">Quick start</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/stargate/docs/edit/HEAD/modules/quickstart/pages/quick_start.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Stargate quickstart</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><strong>time to complete: 5 minutes</strong></p>
</div>
<div class="paragraph">
<p>Stargate is a data gateway deployed between client applications and a database.
In this quickstart, you&#8217;ll be up and running on your local machine with the REST API
plugin that exposes CRUD access to data stored in Cassandra tables.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a><a class="link" href="#_prerequisites">Prerequisites</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use Stargate you need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Docker installed and running</p>
</li>
<li>
<p><code>cURL</code> to run REST queries</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_pull_the_docker_image"><a class="anchor" href="#_pull_the_docker_image"></a><a class="link" href="#_pull_the_docker_image">Pull the Docker image</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This image contains the Cassandra Query Language (CQL) and REST APIs with an Apache Cassandra<sup>&#8482;</sup> 3.11 backend.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker pull stargateio/stargate-3_11:v0.0.3</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_start_the_stargate_container"><a class="anchor" href="#_start_the_stargate_container"></a><a class="link" href="#_start_the_stargate_container">Start the Stargate container</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Start the Stargate container in developer mode.
Developer mode removes the need to set up a separate Cassandra instance and is meant for development and testing only.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker run --name stargate \
  -p 8081:8081 \
  -p 8082:8082 \
  -p 127.0.0.1:9042:9042 \
  -d \
  -e CLUSTER_NAME=stargate \
  -e CLUSTER_VERSION=3.11 \
  -e DEVELOPER_MODE=true \
  stargateio/stargate-3_11:v0.0.3</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, Stargate starts a CQL service on port 9042,
a REST auth service for generating tokens on 8081,
and a REST interface for CRUD on port 8082.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_stargate_rest_api"><a class="anchor" href="#_using_the_stargate_rest_api"></a><a class="link" href="#_using_the_stargate_rest_api">Using the Stargate REST API</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you prefer, you can use Postman as a client interface for exploring REST APIs (<a href="https://www.postman.com/downloads/">download here</a>).
We&#8217;ve provided a <a href="https://github.com/stargate/docs/blob/master/modules/developers-guide/examples/stargate-rest-api.postman_collection.json">Stargate REST API Postman Collection</a> that you can import in Postman to play with the examples shown in this walkthrough.</p>
</div>
<div class="paragraph">
<p>The steps below use <code>cURL</code> to access the REST interface.</p>
</div>
<div class="sect2">
<h3 id="_generate_an_auth_token"><a class="anchor" href="#_generate_an_auth_token"></a><a class="link" href="#_generate_an_auth_token">Generate an auth token</a></h3>
<div class="paragraph">
<p>First generate an auth token that is required in each subsequent request
in the <code>X-Cassandra-Token</code> header.</p>
</div>
<div class="paragraph">
<p>Note the port for the auth service is 8081.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -L -X POST 'http://localhost:8081/v1/auth' \
  -H 'Content-Type: application/json' \
  --data-raw '{
    "username": "cassandra",
    "password": "cassandra"
}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should receive a token in the response.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{"authToken":"{auth-token}"}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Store the auth token in an environment variable to make it easy to use with <code>cURL</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export AUTH_TOKEN={auth-token}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you&#8217;re ready to use the REST API for CRUD operations.</p>
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_keyspace_using_the_rest_api"><a class="anchor" href="#_creating_a_keyspace_using_the_rest_api"></a><a class="link" href="#_creating_a_keyspace_using_the_rest_api">Creating a keyspace using the REST API</a></h3>
<div class="paragraph">
<p>Send a <code>POST</code> request to <code>/v2/schemas/keyspaces</code>.
In this example we use <code>users_keyspace</code> for the <code>name</code>,
and <code>1</code> for the number of data <code>replicas</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl --location --request POST 'localhost:8082/schemas/keyspaces' \
--header "X-Cassandra-Token: $AUTH_TOKEN" \
--header 'Content-Type: application/json' \
--data-raw '{
    "name": "users_keyspace",
    "replicas": 1</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_table_using_the_rest_api"><a class="anchor" href="#_creating_a_table_using_the_rest_api"></a><a class="link" href="#_creating_a_table_using_the_rest_api">Creating a table using the REST API</a></h3>
<div class="paragraph">
<p>Send a <code>POST</code> request to <code>/v2/schemas/keyspaces/{keyspace_name}/tables</code> to create a table.
Set the table name and column definitions in the JSON body.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl --location --request POST 'localhost:8082/schemas/keyspaces/users_keyspace/tables' \
--header "X-Cassandra-Token: $AUTH_TOKEN" \
--header 'Content-Type: application/json' \
--data-raw '{
	"name": "users",
	"columnDefinitions":
	  [
        {
	      "name": "firstname",
	      "typeDefinition": "text"
	    },
        {
	      "name": "lastname",
	      "typeDefinition": "text"
	    },
	    {
	      "name": "email",
	      "typeDefinition": "text"
	    },
        {
	      "name": "favorite color",
	      "typeDefinition": "text"
	    }
	  ],
	"primaryKey":
	  {
	    "partitionKey": ["firstname"],
	    "clusteringKey": ["lastname"]
	  },
	"tableOptions":
	  {
	    "defaultTimeToLive": 0,
	    "clusteringExpression":
	      [{ "column": "lastname", "order": "ASC" }]
	  }
}'</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_write_data"><a class="anchor" href="#_write_data"></a><a class="link" href="#_write_data">Write data</a></h3>
<div class="paragraph">
<p>Send a <code>POST</code> request to <code>/v2/keyspaces/{keyspace_name}/{table_name}</code> to add data to the table.
The column name/value pairs are passed in the JSON body.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl --location --request POST 'localhost:8082/v2/keyspaces/users_keyspace/users' \
--header "X-Cassandra-Token: $AUTH_TOKEN" \
--header 'Content-Type: application/json' \
--data-raw '{
    "firstname": "Mookie",
    "lastname": "Betts",
    "email": "mookie.betts@gmail.com",
    "favorite color": "blue"
}'</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_read_data"><a class="anchor" href="#_read_data"></a><a class="link" href="#_read_data">Read data</a></h3>
<div class="paragraph">
<p>Send a <code>GET</code> request to <code>/v2/keyspaces/{keyspace_name}/{table_name}</code>
to retrieve a row using the primary key of the table in the <code>where</code> params.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -G --location 'http://localhost:8082/v2/keyspaces/users_keyspace/users' \
--header "X-Cassandra-Token: $AUTH_TOKEN" \
--header 'Content-Type: application/json' \
--data-urlencode 'where={"firstname": {"$eq": "Mookie"}}'</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_update_data"><a class="anchor" href="#_update_data"></a><a class="link" href="#_update_data">Update data</a></h3>
<div class="paragraph">
<p>To update a row, send a <code>PUT</code> request to <code>/v2/keyspaces/{keyspace_name}/{table_name}/{path}</code>.
The <code>{path}</code> is comprised of the primary key values.
In this example the partition key is <code>firstname</code> "Mookie" and the clustering key is <code>lastname</code> "Betts"
so we use <code>/Mookie/Betts</code> as the <code>{path}</code> in our request.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl --location --request PUT 'localhost:8082/v2/keyspaces/users_keyspace/users/Mookie/Betts' \
--header "X-Cassandra-Token: $AUTH_TOKEN" \
--header 'Content-Type: application/json' \
--data-raw '{
    "email": "mookie.betts.new-email@email.com"
}'</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Updates are upserts. If the row doesn&#8217;t exist, it will be created.
If it does exist, it will be udpated with the new row data.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_delete_data"><a class="anchor" href="#_delete_data"></a><a class="link" href="#_delete_data">Delete data</a></h3>
<div class="paragraph">
<p>To delete a row, send a <code>DELETE</code> request to <code>/v2/keyspaces/{keyspace_name}/{table_name}/{path}</code>.
In this request we delete all data with the primary key <code>firstname</code> of <code>Mookie</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl --location --request DELETE 'localhost:8082/v2/keyspaces/users_keyspace/users/Mookie' \
--header "X-Cassandra-Token: $AUTH_TOKEN" \
--header 'Content-Type: application/json'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Voila! For more information on the REST API, see the full reference in the REST API section of the docs.</p>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../assets/js/site.js"></script>
<script async src="../../../assets/js/vendor/highlight.js"></script>
  </body>
</html>
